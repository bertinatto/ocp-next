From f41f4ba2f96969992250332f4e466293518f425e Mon Sep 17 00:00:00 2001
From: Fabio Bertinatto <fbertina@redhat.com>
Date: Wed, 27 Nov 2024 13:27:23 -0300
Subject: [PATCH] UPSTREAM: 93286: wait for apiservices on startup

---
 staging/src/k8s.io/kube-aggregator/pkg/apiserver/apiserver.go | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/staging/src/k8s.io/kube-aggregator/pkg/apiserver/apiserver.go b/staging/src/k8s.io/kube-aggregator/pkg/apiserver/apiserver.go
index 8df97a7cc5e..e8e7e8b70f4 100644
--- a/staging/src/k8s.io/kube-aggregator/pkg/apiserver/apiserver.go
+++ b/staging/src/k8s.io/kube-aggregator/pkg/apiserver/apiserver.go
@@ -403,7 +403,7 @@ func (c completedConfig) NewWithDelegate(delegationTarget genericapiserver.Deleg
 			klog.Infof("still waiting on handling APIServices: %v", strings.Join(notYetHandledAPIServices.List(), ","))
 
 			return false, nil
-		}, context.StopCh)
+		}, context.Done())
 		return err
 	})
 
-- 
2.47.0


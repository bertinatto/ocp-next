From d3e4ef7fd1e4364865eff0fcb8a33519fe509132 Mon Sep 17 00:00:00 2001
From: Abu Kashem <akashem@redhat.com>
Date: Fri, 29 Apr 2022 17:51:54 -0400
Subject: [PATCH] UPSTREAM: <carry>: fix [sig-auth] ServiceAccounts no
 secret-based service account token should be auto-generated

OpenShift-Rebase-Source: a03143879c0
---
 test/e2e/auth/service_accounts.go | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/test/e2e/auth/service_accounts.go b/test/e2e/auth/service_accounts.go
index 78163e9b488..4c11233dabe 100644
--- a/test/e2e/auth/service_accounts.go
+++ b/test/e2e/auth/service_accounts.go
@@ -62,7 +62,11 @@ var _ = SIGDescribe("ServiceAccounts", func() {
 			time.Sleep(10 * time.Second)
 			sa, err := f.ClientSet.CoreV1().ServiceAccounts(f.Namespace.Name).Get(ctx, "default", metav1.GetOptions{})
 			framework.ExpectNoError(err)
-			framework.ExpectEmpty(sa.Secrets)
+
+			// TODO: OpenShift creates a Secret with a prefix "default-dockercfg", is the
+			//  following assertion valid?
+			framework.ExpectEqual(len(sa.Secrets), 1)
+			framework.ExpectEqual(strings.HasPrefix(sa.Secrets[0].Name, "default-dockercfg"), true)
 		}
 	})
 
-- 
2.40.1

